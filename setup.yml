---
- name: Install project prerequisites

  hosts: localhost

  vars:

    kubespray_root: ./kubespray

  tasks:

    - name: install requirements
      command: pip install -r requirements.txt

    - name: include private variables
      include_vars:
        dir: "{{ variables }}"

    - name: run ansible galaxy
      command: ansible-galaxy install -r roles/requirements.yml -p galaxy/ --force

    - name: clone kubespray repository
      git:
        repo: https://github.com/kubernetes-incubator/kubespray.git
        version: "{{ kubespray_version }}"
        dest: "{{ kubespray_root }}"

    - name: install kubespray requirements
      command: "pip install -r {{ kubespray_root }}/requirements.txt"

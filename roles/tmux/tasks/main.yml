---
- name: install tmux apt package
  apt: >
    name={{ item }} 
    state=latest
  with_items:
    - tmux
  become: yes
  when: 
    ansible_distribution == "Ubuntu"

- name: install tmux yum package
  yum: >
    name={{ item }} 
    state=latest
  with_items:
    - tmux
  become: yes
  when: 
    ansible_distribution == "CentOS"

- name: create tmux plugin directory
  file: >
    path="~{{ item }}/{{ tmuxplugins }}"
    state=directory
  become: yes
  become_user: "{{ item }}"
  with_items:
    - "{{ users }}"

- name: install tmux plugin manager 
  git: >
    repo=https://github.com/tmux-plugins/tpm.git
    dest="~{{ item }}/{{ tmuxplugins }}/tpm"
  become: yes
  become_user: "{{ item }}"
  with_items:
    - "{{ users }}"

- name: configure tmux
  template:
    src=tmux.conf
    dest="~{{ item }}/{{ tmuxconf }}"
    owner={{ item }}
  become: yes
  become_user: "{{ item }}"
  with_items:
    - "{{ users }}"


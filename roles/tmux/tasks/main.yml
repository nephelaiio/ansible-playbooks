---
- name: install tmux apt package
  apt: >
    name={{ item }} 
    state=latest
  with_items:
    - "{{ tmux_packages }}"
  become: yes
  when: 
    ansible_os_family == "Debian"
  tags:
    - tmux

- name: install tmux yum package
  yum: >
    name={{ item }} 
    state=latest
  with_items:
    - "{{ tmux_packages }}"
  become: yes
  when: 
    ansible_os_family == "RedHat"
  tags:
    - tmux

- name: create tmux plugin directory
  file: >
    path="~{{ item }}/{{ tmux_plugins }}"
    state=directory
  become: yes
  become_user: "{{ item }}"
  with_items:
    - "{{ tmux_users }}"
  tags:
    - tmux
    - tmux.conf

- name: install tmux plugin manager 
  git: >
    repo=https://github.com/tmux-plugins/tpm.git
    dest="~{{ item }}/{{ tmux_plugins }}/tpm"
  become: yes
  become_user: "{{ item }}"
  with_items:
    - "{{ tmux_users }}"
  tags:
    - tmux
    - tmux.conf

- name: configure tmux
  template:
    src=tmux.conf
    dest="~{{ item }}/{{ tmux_conf }}"
    owner={{ item }}
  become: yes
  become_user: "{{ item }}"
  with_items:
    - "{{ tmux_users }}"
  tags:
    - tmux
    - tmux.conf


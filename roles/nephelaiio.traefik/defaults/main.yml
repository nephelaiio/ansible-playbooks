---
# traefik_serviec_domain
traefik_acme_directory: "https://acme-v02.api.letsencrypt.org/directory"
traefik_prefix: traefik
traefik_config_file: /etc/traefik.toml
traefik_dashboard_address: 127.0.0.1
traefik_dashboard_port: 8080
traefik_service_name: traefik
traefik_config:
  checknewversion: "true"
  keeptrailingslash: "true"
  loglevel: INFO
  traefiklog:
    filepath: "/var/log/traefik.log"
    format: json
  accesslog:
    filepath: "/var/log/traefik.access.log"
    format: json
  defaultentrypoints:
    - https
  entrypoints:
    http:
      address: ":80"
      redirect:
        entrypoint: https
    https:
      address: ":443"
      tls:
        minversion: "VersionTLS12"
    traefik:
      address: ":{{ traefik_dashboard_port }}"
  api:
    dashboard: "true"
    debug: "true"
    entrypoint: traefik
  ping:
    entrypoint: http
  acme:
    email: "acme@{{ traefik_service_domain }}"
    caserver: "{{ traefik_acme_directory }}"
    entrypoint: https
    acmeLogging: "true"
    storage: "{{ traefik_prefix }}/acme/account"
    onhostrule: "true"
    ondemand: "true"

traefik_keepalived_manage: yes
keepalived_config: true
keepalived_router_info:
  - name: 'traefik'
    check_script:
      - name: 'chk_traefik'
        script: "[ `curl http://localhost/ping` = 'OK' ]"
        interval: 2
        weight: 2
    master_node: "{{ play_hosts | first }}"
    router_id: '50'
    router_pri_backup: '100'
    router_pri_master: '150'
    vip_int: "{{ ansible_default_ipv4.interface }}"
    vip_addresses:
      - "{{ traefik_cluster_ip }}"

consul_client_scheme: http
consul_client_host: localhost
consul_ports_http: 8500

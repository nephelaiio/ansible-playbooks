---
- name: install vim apt package
  apt: name={{ item }} state=latest
  with_items:
    - vim-nox
  become: yes
  when: 
    ansible_os_family == "Debian"
  tags:
    - vim

- name: install vim alternative
  alternatives: >
    name=editor 
    path=/usr/bin/vim.nox
  become: yes
  when: 
    ansible_os_family == "Debian"
  tags:
    - vim

- name: install vim apt plugins
  apt: >
    name={{ item }} 
    state=latest
  with_items:
    - vim-youcompleteme
    - vim-addon-manager
    - silversearcher-ag
    - vim-conque
    - vim-python-jedi
  notify:
    - activate vim apt plugins
  become: yes
  when: 
    ansible_os_family == "Debian"
  tags:
    - vim
    - vimrc

- name: install vim yum package
  yum: name={{ item }} state=latest
  with_items:
    - vim-enhanced
  become: yes
  when: 
    ansible_os_family == "RedHat"
  tags:
    - vim

- name: create vim plugin directory
  file: >
    path="~{{ item}}/{{ vim_plugins }}"
    state=directory
  become: yes
  become_user: "{{ item }}"
  with_items:
    - "{{ vim_users }}"
  tags:
    - vim
    - vimrc

- name: install vim neobundle
  git: >
    repo=https://github.com/Shougo/neobundle.vim 
    dest="~{{ item }}/{{ vim_plugins }}/neobundle.vim"
  become: yes
  become_user: "{{ item }}"
  with_items:
    - "{{ vim_users }}"
  tags:
    - vim
    - vimrc

- name: install vimrc
  template: >
    src=vimrc
    dest="~{{ item }}/{{ vim_conf }}"
    owner={{ item }}
  become: yes
  become_user: "{{ item }}"
  with_items:
    - "{{ vim_users }}"
  tags:
    - vim
    - vimrc

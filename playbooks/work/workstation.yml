---
- name: Configure workstation

  hosts: icarus

  environment:

    http_proxy: http://10.50.2.254:8080
    https_proxy: http://10.50.2.254:8080

  roles:

    - nephelaiio.tree
    - nephelaiio.vim
    - nephelaiio.devtools
    - nephelaiio.pyenv
    - nephelaiio.tmux
    - nephelaiio.i3
    - nephelaiio.docker
    - nephelaiio.rbenv

  tasks:

    - name: Configure name resolution
      include_role:
        name: ahuffman.resolv
      become: yes
      vars:
        resolv_nameservers:
          - 10.50.2.3
          - 10.50.2.2
        resolv_search:
          - true.local
          - local
        resolv_options:
          - timeout:2
          - rotate

    - name: Install work specific packages
      apt:
        name:
          - openvpn
          - ntfs-3g
          - bridge-utils
          - remmina
          - pkg-config
          - libvirt-bin
          - libvirt-dev
          - keepass2
          - xdotool
        state: latest
        autoclean: yes
        autoremove: yes
      become: yes

    - include: ../upgrade.yml

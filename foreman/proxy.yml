---
- name: Create proxy service

  hosts: foreman_app

  become: yes

  tasks:

    - name: register traefik service
      include_role:
        name: nephelaiio.consul_service
      vars:
        consul_service_address: "{{ ansible_default_ipv4.address }}"
        consul_service_name: foreman
        consul_service_port: 80
        consul_service_cname: "traefik.service.consul.{{ base_domain }}."

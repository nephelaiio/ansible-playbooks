---
- name: Create ovirt centos templates

  hosts: ovirt_engine

  vars:

    engine_fqdn: "{{ ovirt_auth.url | urlsplit('hostname') }}"
    engine_user: "{{ ovirt_auth.username }}"
    engine_password: "{{ ovirt_auth.password }}"
    engine_insecure: yes
    template_memory: 4GiB
    template_cpu: 2
    template_timeout: 900

  roles:

    - nephelaiio.plugins

  tasks:

    - name: manage ovirt templates
      include_role:
        name: ovirt.image-template
      vars:
        template_name: "{{ item.key }}"
        qcow_url: "{{ item.value.url }}"
        template_disk_storage: "{{ item.value.storage_domain }}"
        template_disk_format: "{{ item.value.format | default('cow') }}"
        template_cluster: "{{ item.value.cluster }}"
        template_type: "{{ item.value.type | default('server') }}"
      loop_control:
        label: "{{ item.key }}"
      loop: "{{ ovirt_templates | dict2items }}" 

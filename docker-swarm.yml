---
- name: Install and configure docker

  hosts: docker_swarm

  become: yes

  roles:

    - atosatto.docker-swarm

  vars:

    docker_admin_users: "{{ lookup('env', 'USER') }}"

  tasks:

    - name: install docker swarm
      include_role:
        name: atosatto.docker-swarm
      become: yes

    - name: install nfs client
      package:
        name: nfs-common
      become: yes


- name: Configure swarm master node

  hosts: docker_swarm_manager

  become: yes

  tasks:

    - name: dedicate swarm master
      command: "docker node update --availability drain {{ ansible_hostname }}"

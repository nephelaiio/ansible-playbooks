---
awx_url: "https://awx.{{ base_domain }}"
awx_release: "5.0.0"
awx_admin_pass: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  38326437383561303736613837343736396238303031653035363861656139663364326635643361
  3036623232343863343639333135363830343431383137350a646530386137653536363632366263
  38393163666636346335383832373162663761646164323332306365363834383332353030356661
  3539336136633562650a303563306264386132363432313661333835653330373539383866616635
  6561
awx_secret_key: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  63363435626262373830366530333236363730666131623236303137323933636661313838383034
  3330663031393036343666336131653764303633313438310a316662666332653338363933636165
  37613031626266656434633032306534633965626365663064376632383338326665323565653731
  6461373166346366360a323138666432333738383965373464643333356561333636323431626166
  66346663373539326534613665366334633432643830333236306233373061366435
awx_host_key: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  66346565313831663761313939383638633134333838613563373336396438316364306634656564
  3366633336636131313837336433326331613434663234660a613565373966393432363430353162
  66363237363134616234356165663961386264383931366564343062353831653633616665336139
  3738306462363131320a643837393533333335396665663935323361306332356666373466323934
  30393032653933643862633038336565633561303862323936336439653232323464303764623164
  3731353562616236663932316435326138653532666231323164
awx_pg_pass: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  64643935323165383633343735653962613837363439336264383162323735373065323631363038
  6634306535376531663962333865396137336263306166360a396536666462326236383532383339
  33393233653464623230393832633465376164373762313532613932663065613638663730343339
  6636663631363039390a316237366131646438653963646532633564363165623565613036656164
  65666438363832613065396565636139663031616531343165666363643134353430
awx_vault_home_pass: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  66616633663061313038353939363661663839316431353133663561383665623961353338343530
  6432366262316231376533393362656234616333326464610a356236356434386539316533653235
  37386239653932386139376134626662306331343233373936353566613165643036366666326532
  6139373733323333300a636165343838643137346161356366646433393062383338646233303666
  3663
awx_rabbitmq_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  61386430613038316235653034333963333734316665643033353564376661303236383339623866
  3730623036343365366630303136363435353764316139340a393530313161303965366365366264
  63643734343265386434653830383337663933623963613832613339613933343761333131316661
  6538356164373139650a343938363465383238373862643136373062396236383130646133303335
  34646538386363643138396162333664353230333065393338393131316635663362

awx_github_user: teddyphreak
awx_github_pass: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  63626136643237376161363063363330633535353437636131616361653961356634343464616563
  3364306363663562383330326530643437643666333932370a393465343332353534333233663365
  34343132313934363862306636356233336133343765383639613430333038386239373161653861
  3165393266346438390a393433613038323334393437373861383133393565656235626139383630
  3332

awx_organizations:

  - name: home
    state: present

    credentials:
      - name: github.com
        kind: scm
        inputs:
          username: "{{ awx_github_user }}"
          password: "{{ awx_github_pass }}"
      - name: home.vault
        kind: vault
        inputs:
          vault_password: "{{ awx_vault_home_pass }}"
      - name: home.ssh
        kind: ssh
        inputs:
          username: "{{ users.teddyphreak.username }}"
          ssh_key_data: "{{ users.teddyphreak.privkey }}"

    projects:
      - name: nephelai.io
        scm_type: git
        scm_url: https://github.com/nephelaiio/ansible-playbooks.git
        scm_branch: master
        scm_delete_on_update: false
        scm_credential: github.com
        scm_update_on_launch: true
        scm_update_cache_timeout: 60
        scm_clean: false

    inventories:
      - name: home
        source: scm
        source_project: nephelai.io
        source_path: inventory/home
        overwrite: true
        overwrite_vars: true
        update_on_launch: true
        update_on_project_update: false

    templates:
      - name: ping.home
        job_type: run
        project: nephelai.io
        inventory: home
        playbook: ping.yml
        vault_credential: home.vault
        credential: home.ssh
      - name: upgrade.home
        job_type: run
        project: nephelai.io
        inventory: home
        playbook: upgrade.yml
        vault_credential: home.vault
        credential: home.ssh
      - name: dhcp.home
        job_type: run
        project: nephelai.io
        inventory: home
        playbook: dhcp.yml
        vault_credential: home.vault
        credential: home.ssh
        host_config_key: "{{ awx_host_key }}"
      - name: dns.home
        job_type: run
        project: nephelai.io
        inventory: home
        playbook: dns.yml
        vault_credential: home.vault
        credential: home.ssh
        host_config_key: "{{ awx_host_key }}"

    workflows:
      - name: home
        nodes:
          - name: upgrade
            template: upgrade.home
          - name: dns
            template: dns.home
            parent: upgrade
          - name: dhcp
            template: dhcp.home
            parent: dns

    schedules:
      - name: home
        job_template: home
        enabled: true
        rrule: "DTSTART:20180826T000000Z RRULE:FREQ=DAILY;INTERVAL=1"
        state: absent

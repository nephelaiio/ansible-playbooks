---
timezone: America/Costa_Rica

kolla_release: 5.0.0.0rc1
kolla_installer: resources/kolla

awx_release: 1.0.0
awx_installer: resources/awx
awx_url: http://awx.home.nephelai.io

sensu_url: http://sensu.home.nephelai.io
apt_url: http://apt.home.nephelai.io

servers:
  dhcp: "{{ groups['dhcp'] | map('extract', hostvars, ['ansible_host']) | list }}"
  recursors: "{{ groups['recursors'] | map('extract', hostvars, ['ansible_host']) | list }}"
  dns: "{{ groups['pdns'] | map('extract', hostvars, ['ansible_host']) | list }}"

nets:
  home:
    network: 192.168.0.0
    netmask: 255.255.255.0
    router: 192.168.0.1
    zone: 0.168.192.in-addr.arpa
    ns: "{{ servers.recursors }}"
    pools:
      - range: '192.168.0.65 192.168.0.127'
    reservations:
      cerberus.home.nephelai.io:
        host: "{{ hostvars['cerberus.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['cerberus.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['cerberus.home.nephelai.io']['hw_address'] }}"
      rpia.home.nephelai.io:
        host: "{{ hostvars['rpia.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['rpia.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['rpia.home.nephelai.io']['hw_address'] }}"
      rpib.home.nephelai.io:
        host: "{{ hostvars['rpib.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['rpib.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['rpib.home.nephelai.io']['hw_address'] }}"
      rpic.home.nephelai.io:
        host: "{{ hostvars['rpic.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['rpic.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['rpic.home.nephelai.io']['hw_address'] }}"
      rpid.home.nephelai.io:
        host: "{{ hostvars['rpid.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['rpid.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['rpid.home.nephelai.io']['hw_address'] }}"
      rpie.home.nephelai.io:
        host: "{{ hostvars['rpie.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['rpie.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['rpie.home.nephelai.io']['hw_address'] }}"
      nuca.home.nephelai.io:
        host: "{{ hostvars['nuca.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['nuca.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['nuca.home.nephelai.io']['hw_address'] }}"
  private:
    network: 192.168.254.0
    netmask: 255.255.255.0
    router: 192.168.254.1
    ns: "{{ servers.recursors }}"
    pools:
      - range: '192.168.254.65 192.168.254.127'
    reservations:
      kvma.home.nephelai.io:
        host: "{{ hostvars['kvma.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['kvma.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['kvma.home.nephelai.io']['hw_address'] }}"
      kvmb.home.nephelai.io:
        host: "{{ hostvars['kvmb.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['kvmb.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['kvmb.home.nephelai.io']['hw_address'] }}"
      kvmc.home.nephelai.io:
        host: "{{ hostvars['kvmc.home.nephelai.io']['inventory_hostname'] }}"
        ip-address: "{{ hostvars['kvmc.home.nephelai.io']['ansible_host'] }}"
        hw-address: "{{ hostvars['kvmc.home.nephelai.io']['hw_address'] }}"

dns:
  zones:
    home:
      name: home.nephelai.io
      hostmaster: master@home.nephelai.io
      mx:
        - name: rpia.home.nephelai.io
      ns:
        - name: rpic.home.nephelai.io
      records: "{{ nets.home.reservations.values() }}"
      cnames:
        home.nephelai.io: rpia.home.nephelai.io
        unifi.home.nephelai.io: "{{ groups['unifi'] | map('extract', hostvars, ['inventory_hostname']) | list | first }}"
        nfs.home.nephelai.io: "{{ groups['backup'] | map('extract', hostvars, ['inventory_hostname']) | list | first }}"
        "{{ apt_url }}": "{{ groups['mirror'] | map('extract', hostvars, ['inventory_hostname']) | list | first }}"
        "{{ sensu_url }}": "{{ groups['sensu'] | map('extract', hostvars, ['inventory_hostname']) | list | first }}"
    emoh:
      name: "{{ nets.home.zone }}"
      hostmaster: master@home.nephelai.io
      ns:
        - name: rpic.home.nephelai.io
      mx: []
      records: "{{ nets.home.reservations.values() | map('reverse_record') | list }}"
      cnames: []

---
foreman_url: "https://foreman.{{ base_domain }}"
foreman_admin_pass: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  30653062303830393833303933316162303435376238656532616361306464636338346538373133
  3362626134323163366366356366663535616566393833630a386335316436356139663235666362
  64633263636334323439663331393039303863333866313233613361316361383661386631643937
  3333313062313839380a656562343632663738326131313963316239643961313735616266366166
  36353064626139333133346164623839313861336538373739613662393563376337
foreman_installer_admin_user: "{{ foreman_admin_user }}"
foreman_installer_admin_password: "{{ foreman_admin_pass }}"
foreman_oauth_consumer_key: installer_key
foreman_oauth_consumer_secret: legsLONDONMATCHstory

foreman_server_ssl_ca: /etc/puppetlabs/puppet/ssl/certs/ca.pem
foreman_server_ssl_cert: "/etc/puppetlabs/puppet/ssl/certs/{{ inventory_hostname }}.pem"
foreman_server_ssl_key: "/etc/puppetlabs/puppet/ssl/private_keys/{{ inventory_hostname }}.pem"
foreman_proxy_ssl_ca: "{{ foreman_server_ssl_ca }}"
foreman_proxy_ssl_cert: "{{ foreman_server_ssl_cert }}"
foreman_proxy_ssl_key: "{{ foreman_server_ssl_key }}"

puppet_agent_server: "{{ groups['foreman_app'] | map('extract', hostvars, ['inventory_hostname']) | first }}"

foreman_organizations:
  - Default Organization
foreman_locations:
  - Default Location

foreman_os:
  - name: Ubuntu
    family: Debian
    architecture: x86_64
    major: 18.04
    release_name: bionic
    ptables:
      - "Preseed default"
    provisioning_templates:
      - "Preseed default"
      - "Preseed default finish"
      - "Preseed default PXELinux"
    media:
      - Ubuntu mirror
    password_hash: SHA512
  - name: CentOS
    family: Redhat
    architecture: x86_64
    major: 7
    ptables:
      - "Kickstart default"
    provisioning_templates:
      - "Kickstart default"
      - "Kickstart default finish"
      - "Kickstart default PXELinux"
    media:
      - CentOS mirror
    password_hash: SHA512

foreman_subnet_pxe: "{{ nets.pxe.network }}/{{ nets.pxe.netmask }}"

foreman_hostgroups:
  - name: Ubuntu Bionic
    architecture: x86_64
    operatingsystem: Ubuntu
    pxe_loader: PXELinux BIOS
    subnet: "{{ foreman_subnet_pxe | ipaddr('network') }}/{{ foreman_subnet_pxe | ipaddr('prefix') }}"
    domain: "{{ base_domain }}"
    root_pass: "{{ users.root.password  | password_hash('sha512') }}"
    foreman_organizations: "{{ foreman_organizations }}"
    foreman_locations: "{{ foreman_locations }}"
    ptable: "Preseed default"
    group_parameters_attributes:
      - name: remote_execution_ssh_user
        value: "{{ users.teddyphreak.username }}"
      - name: remote_execution_ssh_keys
        value: "{{ users.teddyphreak.pubkey }}"
      - name: remote_execution_create_user
        value: true
      - name: remote_execution_effective_user_method
        value: sudo
      - name: partitioning-vg-name
        value: ubuntu
  - name: CentOS7
    architecture: x86_64
    operatingsystem: CentOS
    pxe_loader: PXELinux BIOS
    subnet: "{{ foreman_subnet_pxe | ipaddr('network') }}/{{ foreman_subnet_pxe | ipaddr('prefix') }}"
    domain: "{{ base_domain }}"
    root_pass: "{{ users.root.password  | password_hash('sha512') }}"
    foreman_organizations: "{{ foreman_organizations }}"
    foreman_locations: "{{ foreman_locations }}"
    ptable: "Kickstart default"
    group_parameters_attributes:
      - name: selinux-mode
        value: disabled
      - name: disable-firewall
        value: true
      - name: enable-epel
        value: false
      - name: remote_execution_ssh_user
        value: "{{ users.teddyphreak.username }}"
      - name: remote_execution_ssh_keys
        value: "{{ users.teddyphreak.pubkey }}"
      - name: remote_execution_create_user
        value: true
      - name: remote_execution_effective_user_method
        value: sudo
